function FixedCardWidget(t,i,e){if("id"===t)var s=document.getElementById(i);else s=document.getElementsByClassName(i)[e];s&&(s.className.indexOf("fixed-card-widget")>-1?RemoveFixedCardWidget():(RemoveFixedCardWidget(),CreateQuitBox(),s.classList.add("fixed-card-widget")))}function CreateQuitBox(){document.getElementById("aside-content").insertAdjacentHTML("beforebegin",'<div id="quit-box" onclick="RemoveFixedCardWidget()"></div>')}function RemoveFixedCardWidget(){var t=document.querySelectorAll(".fixed-card-widget");if(t)for(i=0;i<t.length;i++)t[i].classList.remove("fixed-card-widget");var e=document.getElementById("quit-box");e&&e.remove()}RemoveFixedCardWidget();class Player{constructor(){return this.getInstance(...arguments)}getInstance(){let t=new PlayerCreator(...arguments);return Player.instance=t,t}}class Musics{constructor(){this.songs=[{id:1,title:"还是会想你",singer:"林达浪,h3R3",songUrl:"https://anxkj1.s3.bitiful.net/2024/03/a6e99101597f8b95b23244d4c7ec35c7.mp3",imageUrl:"https://y.qq.com/music/photo_new/T062R300x300M000003mB6gw1h4TGz.jpg?max_age=2592000"},{id:2,title:"还是会想你",singer:"林达浪,h3R3",songUrl:"https://anxkj1.s3.bitiful.net/2024/03/a6e99101597f8b95b23244d4c7ec35c7.mp3",imageUrl:"https://y.qq.com/music/photo_new/T062R300x300M000003mB6gw1h4TGz.jpg?max_age=2592000"},{id:3,title:"还是会想你",singer:"林达浪,h3R3",songUrl:"https://anxkj1.s3.bitiful.net/2024/03/a6e99101597f8b95b23244d4c7ec35c7.mp3",imageUrl:"https://y.qq.com/music/photo_new/T062R300x300M000003mB6gw1h4TGz.jpg?max_age=2592000"},{id:4,title:"闹海",singer:"毛亮",songUrl:"https://anxkj1.s3.bitiful.net/2024/04/6ce17f5b39095793a0b70daf7b405efd.ogg",imageUrl:"https://y.qq.com/music/photo_new/T002R300x300M000003GSuuh3xEmeM_4.jpg?max_age=2592000"},{id:5,title:"刚好遇见你",singer:"李玉刚",songUrl:"https://anxkj1.s3.bitiful.net/2024/02/58b004c56b6ab6ce1ca3c1e8c6781d0e.mp3",imageUrl:"https://y.qq.com/music/photo_new/T002R300x300M000002qBBpu2q0vL3_1.jpg?max_age=2592000"},{id:6,title:"Da Da Da",singer:"Tanir & Tyomcha",songUrl:"https://anxkj1.s3.bitiful.net/2024/03/304afe912db65c66d5a714a43f10390a.mp3",imageUrl:"https://y.qq.com/music/photo_new/T002R300x300M000003SFg6p4GZktQ_2.jpg?max_age=2592000"},{id:7,title:"不眠之夜：星穹铁道",singer:"张杰/MOYO-Mix",songUrl:"https://anxkj1.s3.bitiful.net/music/%E5%BC%A0%E6%9D%B0%20_%20HOYO-MiX%20-%20%E4%B8%8D%E7%9C%A0%E4%B9%8B%E5%A4%9C.flac",imageUrl:"https://y.qq.com/music/photo_new/T002R300x300M000004ItRwk3R0LYz_1.jpg?max_age=2592000"},{id:8,title:"WHITE NIGHT",singer:"西山晃世 / HOYO-MiX",songUrl:"https://anxkj1.s3.bitiful.net/music/西山晃世 _ HOYO-MiX - WHITE NIGHT (不眠之夜).flac",imageUrl:"https://y.qq.com/music/photo_new/T002R300x300M000004ItRwk3R0LYz_1.jpg?max_age=2592000"},{id:9,title:"无定骨",singer:"三叔说",songUrl:"https://anxkj1.s3.bitiful.net/music/%E6%97%A0%E5%AE%9A%E9%AA%A8.mp3",imageUrl:"https://y.qq.com/music/photo_new/T002R300x300M000000Dnr3l2fmdUB_1.jpg?max_age=2592000"},{id:10,title:"鸳鸯戏 (DJ降速版)",singer:"Babystop_山竹 / 伊笑",songUrl:"https://anxkj1.s3.bitiful.net/music/%E9%B8%B3%E9%B8%AF%E6%88%8F.mp3",imageUrl:"https://y.qq.com/music/photo_new/T002R300x300M000004S5O6N3qCGW9_2.jpg?max_age=2592000"},{id:11,title:"TIRED OF PROBLEMS",singer:"NUEKI / TOLCHONOV / Glichery",songUrl:"https://anxkj1.s3.bitiful.net/music/TIRED%20OF%20PROBLEMS.mp3",imageUrl:"https://img4.kuwo.cn/star/albumcover/120/80/43/2004299551.jpg"},{id:12,title:"把回忆拼好给你",singer:"夏雨不下鱼",songUrl:"https://anxkj1.s3.bitiful.net/music/%E5%A4%8F%E9%9B%A8%E4%B8%8D%E4%B8%8B%E9%B1%BC%20-%20%E6%8A%8A%E5%9B%9E%E5%BF%86%E6%8B%BC%E5%A5%BD%E7%BB%99%E4%BD%A0.ogg",imageUrl:"https://y.qq.com/music/photo_new/T062R300x300M000002PCg374ZfDsU.jpg?max_age=2592000"},{id:13,title:"画离弦",singer:"海伦",songUrl:"/anxkj/music/海伦 - 画离弦 (DJ亚明版).MP3",imageUrl:"https://y.qq.com/music/photo_new/T002R300x300M000000JG3ZY3ZzUlf_2.jpg?max_age=2592000"},{id:14,title:"答案",singer:"深空灰",songUrl:"https://anxkj1.s3.bitiful.net/music/%E6%B7%B1%E7%A9%BA%E7%81%B0%20-%20%E7%AD%94%E6%A1%88%20(%E5%BF%AB%E4%B9%90%E5%8A%A0%E9%80%9F%E7%89%88).ogg",imageUrl:"https://y.qq.com/music/photo_new/T062R300x300M000003mB6gw1h4TGz.jpg?max_age=2592000"},{id:15,title:"Honest",singer:"rei brown",songUrl:"https://anxkj1.s3.bitiful.net/2024/02/252e10a5d753ae10ce72ceb0a7a2b59b.mp3",imageUrl:"https://y.qq.com/music/photo_new/T002R300x300M000002qBBpu2q0vL3_1.jpg?max_age=2592000"}]}getSongByNum(t){return this.songs[t]}}class PlayerCreator{constructor(){this.audio=document.querySelector(".music-player__audio"),this.audio.volume=.2,this.util=new Util,this.musics=new Musics,this.song_index=0,this.loop_mode=1,this.song_list=$(".music__list_content"),this.render_doms={title:$(".music__info--title"),singer:$(".music__info--singer"),image:$(".music-player__image img"),blur:$(".music-player__blur")},this.ban_dom={control__btn:$(".control__volume--icon")},this.render_time={now:$(".nowTime"),total:$(".totalTime")},this.disc={image:$(".music-player__image"),pointer:$(".music-player__pointer")},this.init()}init(){this.renderSongList(),this.renderSongStyle(),this.bindEventListener()}renderSongList(){let t="";this.musics.songs.forEach(((i,e)=>{t+=`<li class="music__list__item">${i.title}</li>`})),this.song_list.html(t)}renderSongStyle(){let{title:t,singer:i,songUrl:e,imageUrl:s}=this.musics.getSongByNum(this.song_index);this.audio.src=e,this.render_doms.title.html(t),this.render_doms.singer.html(i),this.render_doms.image.prop("src",s),this.render_doms.blur.css("background-image",'url("'+s+'")'),this.song_list.find(".music__list__item").eq(this.song_index).addClass("play").siblings().removeClass("play")}bindEventListener(){this.$play=new Btns(".player-control__btn--play",{click:this.handlePlayAndPause.bind(this)}),this.$prev=new Btns(".player-control__btn--prev",{click:this.changeSong.bind(this,"prev")}),this.$next=new Btns(".player-control__btn--next",{click:this.changeSong.bind(this,"next")}),this.$mode=new Btns(".player-control__btn--mode",{click:this.changePlayMode.bind(this)}),this.$ban=new Btns(".control__volume--icon",{click:this.banNotes.bind(this)}),this.song_list.on("click","li",(t=>{let i=$(t.target).index();this.changeSong(i)})),new Progress(".control__volume--progress",{min:0,max:1,value:this.audio.volume,handler:t=>{this.audio.volume=t}}),this.audio.oncanplay=()=>{if(this.progress)return this.progress.max=this.audio.duration,this.render_time.total.html(this.util.formatTime(this.audio.duration)),!1;this.progress=new Progress(".player__song--progress",{min:0,max:this.audio.duration,value:0,handler:t=>{this.audio.currentTime=t}}),this.render_time.total.html(this.util.formatTime(this.audio.duration))},this.audio.ontimeupdate=()=>{this.progress.setValue(this.audio.currentTime),this.render_time.now.html(this.util.formatTime(this.audio.currentTime))},this.audio.onended=()=>{this.changeSong("next"),this.audio.play()}}handlePlayAndPause(){let t=this.$play.$el.find("i");this.audio.paused?(this.audio.play(),t.removeClass("icon-play").addClass("icon-pause"),this.disc.image.addClass("play"),this.disc.pointer.addClass("play")):(this.audio.pause(),t.addClass("icon-play").removeClass("icon-pause"),this.disc.image.removeClass("play"),this.disc.pointer.removeClass("play"))}changePlayMode(){this.loop_mode++,this.loop_mode>2&&(this.loop_mode=0),this.renderPlayMode()}renderPlayMode(){this.$mode.$el.find("i").prop("class","iconfont icon-"+["loop","random","single"][this.loop_mode])}changeSongIndex(t){if("number"==typeof t)this.song_index=t;else if(0===this.loop_mode)this.song_index+="next"===t?1:-1,this.song_index>this.musics.songs.length-1&&(this.song_index=0),this.song_index<0&&(this.song_index=this.musics.songs.length-1);else if(1===this.loop_mode){let t=this.musics.songs.length,i=Math.floor(Math.random()*t);for(let e=0;e<1e4;e++){if(this.song_index!=i){this.song_index=i;break}i=Math.floor(Math.random()*t)}}else 2===this.loop_mode&&(this.song_index=this.song_index)}songTime(){let t=parseInt(this.audio.duration/60)<10?"0"+parseInt(this.audio.duration/60):parseInt(this.audio.duration/60),i=parseInt(this.audio.duration%60)<10?"0"+parseInt(this.audio.duration%60):parseInt(this.audio.duration%60);$(".totalTime").text(t+":"+i)}changeSong(t){this.changeSongIndex(t);let i=this.audio.paused;this.renderSongStyle(),i||this.audio.play()}banNotes(){let t=this.$ban.$el.find("i");1==this.audio.muted?(this.audio.muted=!1,t.removeClass("icon-muted").addClass("icon-volume")):(this.audio.muted=!0,t.removeClass("icon-volume").addClass("icon-muted"))}}class Progress{constructor(t,i){$.extend(this,i),this.$el=$(t),this.width=this.$el.width(),this.init()}init(){this.renderBackAndPointer(),this.bindEvents(),this.drag(),this.value,this.changeDOMStyle(this.width*this.value)}renderBackAndPointer(){this.$back=$('<div class="back">'),this.$pointer=$('<div class="pointer">'),this.$el.append(this.$back),this.$el.append(this.$pointer)}setValue(t){let i=this.width*t/(this.max-this.min);this.changeDOMStyle(i)}drag(){let t=this.$pointer,i=this.$el,e=!1;t.mousedown((s=>{e=!0;let n=s.offsetX;$(document).mousemove((s=>{if(!0===e){let e=s.clientX-i.offset().left-n,o=Math.max(0,Math.min(e,i.outerWidth(!1)-t.outerWidth(!1))),a=o/i.outerWidth(!1)*(this.max-this.min);this.changeDOMStyle(o),this.handler(a)}}))})),$(document).mouseup((()=>{e=!1}))}bindEvents(){this.$el.click((t=>{let i=t.offsetX,e=i/this.width*(this.max-this.min);this.changeDOMStyle(i),this.handler(e)}))}changeDOMStyle(t){this.$back.width(t+7==7?0:t+7),this.$pointer.css("left",t+"px")}}class Btns{constructor(t,i){this.$el=$(t),this.bindEvents(i)}bindEvents(t){for(const i in t)t.hasOwnProperty(i)&&this.$el.on(i,t[i])}}new Player,document.addEventListener("pjax:complete",(t=>{new Player}));